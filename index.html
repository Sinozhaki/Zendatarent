<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rent Linkedin By Zen</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #D4AF37;
            --light-gold: #F7DE98;
            --dark-gold: #a48226;
            --dark-bg: #121212;
            --dark-card: #1a1a1a;
            --text-gold: #f0e6d2;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(170deg, #1a1a1a 0%, #121212 40%, #1a1a1a 100%);
            background-attachment: fixed;
            color: var(--text-gold);
        }

        /* --- Animations --- */
        @keyframes flow {
            0% { background-position: -100% 50%; }
            100% { background-position: 100% 50%; }
        }

        @keyframes luxuryShine {
            0% { transform: translateX(-150%) skewX(-25deg); }
            100% { transform: translateX(150%) skewX(-25deg); }
        }

        /* --- Components --- */
        .glass-card {
            background-color: rgba(26, 26, 26, 0.5);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(212, 175, 55, 0.2);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        .animated-gold-border {
            position: relative;
            padding: 2px;
            overflow: hidden;
            z-index: 1;
        }
        .animated-gold-border::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(120deg, transparent, var(--light-gold), var(--gold), transparent);
            background-size: 200% 100%;
            animation: flow 3s linear infinite;
            z-index: -1;
        }
        
        .luxury-shine-effect {
            position: relative;
            overflow: hidden;
        }
        .luxury-shine-effect::after {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 50%; height: 100%;
            background: linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,0.07) 50%, rgba(255,255,255,0) 100%);
            animation: luxuryShine 5s infinite linear;
            z-index: 1;
            pointer-events: none;
        }

        h1 {
            color: var(--gold);
            text-shadow: 0 0 15px rgba(212, 175, 55, 0.5);
        }

        /* --- Menu Navigation --- */
        #menuContainer button {
            color: var(--text-gold);
            transition: all 0.3s ease;
        }
        #menuContainer button.active {
            color: #fff;
            text-shadow: 0 0 10px var(--light-gold);
            background-color: rgba(212, 175, 55, 0.2);
        }
        #menuContainer button:not(.active):hover {
            color: #fff;
            background-color: rgba(212, 175, 55, 0.1);
        }

        /* --- Table --- */
        #publicTable {
            background-color: transparent;
            position: relative;
            z-index: 2;
            color: var(--text-gold);
        }
        #publicTable thead {
           color: var(--gold);
           border-bottom: 1px solid rgba(212, 175, 55, 0.3);
        }
        #publicTable tbody tr {
           border-bottom: 1px solid rgba(212, 175, 55, 0.1);
        }
        #publicTable tbody tr:last-child { border-bottom: none; }
        
        /* --- Forms & Inputs --- */
        input, select, textarea {
            background-color: rgba(0,0,0,0.3);
            border: 1px solid rgba(212, 175, 55, 0.3);
            color: var(--text-gold);
        }
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.5);
        }
        
        /* --- Admin View --- */
        #singleDataView { color: var(--text-gold); }
        #singleDataView .font-bold { color: var(--gold); }
        #singleDataView .border-b { border-color: rgba(212, 175, 55, 0.3); }

        /* Responsive */
        @media (max-width: 640px) {
            .animated-gold-border::before, .luxury-shine-effect::after { display: none; }
            #publicTable thead { display: none; }
            #publicTable, #adminTable, #publicTable tbody { display: block; width: 100%; }
            #publicTable tr {
                display: block;
                margin-bottom: 1rem;
                border-radius: 0.5rem;
                overflow: hidden;
                position: relative;
                padding: 1px;
            }
            #publicTable tr::before { /* Border animation for each card */
                content: '';
                position: absolute;
                top: 0; left: 0; right: 0; bottom: 0;
                background: linear-gradient(120deg, transparent, var(--light-gold), transparent);
                background-size: 200% 100%;
                animation: flow 3s linear infinite;
                z-index: 1;
            }
            #publicTable td {
                display: flex; justify-content: space-between; align-items: center;
                padding: 0.75rem 1rem; text-align: right; color: inherit;
                background-color: var(--dark-card);
                border-bottom: 1px solid rgba(212, 175, 55, 0.1);
                position: relative; z-index: 2;
            }
            #publicTable tr > td:first-of-type { border-top-left-radius: 0.375rem; border-top-right-radius: 0.375rem; }
            #publicTable tr > td:last-of-type { border-bottom-left-radius: 0.375rem; border-bottom-right-radius: 0.375rem; border-bottom: none;}
            #publicTable td::before { content: attr(data-label); font-weight: 600; text-align: left; flex-grow: 1; padding-right: 1rem; color: var(--gold); }
        }
        
        /* Blinking light */
        @keyframes blink-green { 0%, 100% { background-color: #22c55e; } 50% { background-color: transparent; } }
        @keyframes blink-red { 0%, 100% { background-color: #ef4444; } 50% { background-color: transparent; } }
        .blinking-light { width: 10px; height: 10px; border-radius: 50%; margin-left: 8px; flex-shrink: 0; }
        .blinking-light.green { animation: blink-green 1s linear infinite; }
        .blinking-light.red { animation: blink-red 1s linear infinite; }
    </style>
</head>
<body id="appBody">
    <div id="contentContainer" class="max-w-4xl mx-auto rounded-xl p-6 md:p-8">
        <h1 class="text-4xl font-bold text-center mb-8">Rent Linkedin By Zen</h1>

        <!-- Menu Kaca -->
        <div class="flex justify-center items-center mb-8">
            <div id="menuContainer" class="glass-card p-1 rounded-full flex w-fit">
                <button id="showTableBtn" class="font-semibold py-2 px-6 rounded-full">Tabel</button>
                <button id="showAdminBtn" class="font-semibold py-2 px-6 rounded-full">Admin Mode</button>
            </div>
        </div>

        <!-- Notifikasi -->
        <div id="notification" class="hidden fixed top-4 right-4 bg-green-500 text-white py-3 px-5 rounded-lg shadow-xl z-50 transition-transform duration-300 transform scale-0 origin-right"></div>

        <!-- Bagian Tabel (Public View) -->
        <div id="tableView" class="space-y-4">
            <div class="flex flex-col sm:flex-row justify-between items-center mb-4 gap-4">
                <div class="w-full sm:w-auto flex-grow relative">
                    <input type="text" id="emailSearchInput" placeholder="Cari email..." class="w-full pl-4 pr-10 py-2 rounded-lg">
                    <button id="clearSearchBtn" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white hidden"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.707-10.293a1 1 0 00-1.414-1.414L8 8.586 6.707 7.293a1 1 0 10-1.414 1.414L6.586 10l-1.293 1.293a1 1 0 101.414 1.414L8 11.414l1.293 1.293a1 1 0 001.414-1.414L9.414 10l1.293-1.293z" clip-rule="evenodd" /></svg></button>
                </div>
                <div>
                     <select id="statusFilterSelect" class="w-full sm:w-auto rounded-lg py-2 px-3">
                        <option value="semua">Filter: Semua Status</option>
                        <option value="Running">Running</option>
                        <option value="Restric">Restric</option>
                        <option value="Unrestric">Unrestric</option>
                        <option value="running old">Old</option>
                    </select>
                </div>
            </div>

            <div class="table-container-animated-border animated-gold-border glass-card luxury-shine-effect">
                <table id="publicTable" class="min-w-full table-auto">
                    <thead><tr><th class="py-3 px-4 font-semibold text-left">Email</th><th class="py-3 px-4 font-semibold text-left">Keterangan</th></tr></thead>
                    <tbody id="dataTableBody" class="text-sm"></tbody>
                </table>
            </div>
            <div id="loadingIndicatorTable" class="text-center py-4 font-semibold hidden">Mengambil data...</div>
        </div>
        
        <!-- Welcome Modal -->
        <div id="welcomeModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[1000]">
            <div class="glass-card rounded-lg p-8 text-center max-w-sm mx-4 animated-gold-border">
                <div class="relative z-10 bg-dark-card rounded-md p-6">
                    <h2 class="text-2xl font-bold mb-4 text-gold">Selamat Datang</h2>
                    <p class="text-sm text-gray-400 mb-6">Indikator Merah = Restric, Hijau = Akun Aman.</p>
                    <audio id="backgroundMusic" src="music.mp3" preload="auto"></audio>
                    <button id="continueBtn" class="bg-gold text-dark-bg font-semibold py-2 px-6 rounded-lg shadow-md hover:bg-light-gold transition w-full">Lanjutkan</button>
                </div>
            </div>
        </div>

        <!-- Bagian Admin Mode -->
        <div id="adminView" class="hidden space-y-6">
            <div id="passwordSection" class="glass-card rounded-lg p-6">
                <label for="passwordInput" class="block font-medium mb-2 text-gold">Masukkan Sandi Admin:</label>
                <input type="password" id="passwordInput" class="w-full px-4 py-2 rounded-lg">
                <button id="submitPasswordBtn" class="mt-4 w-full bg-gold text-dark-bg font-semibold py-2 px-4 rounded-lg hover:bg-light-gold transition">Masuk</button>
            </div>

            <div id="adminFormSection" class="hidden space-y-6">
                 <div class="flex justify-end">
                    <button id="showHistoryBtn" class="bg-gray-700 text-white font-semibold py-2 px-4 rounded-lg hover:bg-gray-600 transition">Riwayat Hapus</button>
                </div>

                <div id="singleDataView" class="glass-card rounded-lg p-6 space-y-4 luxury-shine-effect">
                    <div id="dataCard" class="space-y-3" style="position: relative; z-index: 2;"></div>
                    <div class="flex justify-between items-center mt-4">
                        <button id="prevDataBtn" class="bg-gray-700 text-white font-semibold py-2 px-4 rounded-lg hover:bg-gray-600 disabled:opacity-50">Sebelumnya</button>
                        <span id="dataIndexDisplay" class="font-bold text-sm"></span>
                        <button id="nextDataBtn" class="bg-gray-700 text-white font-semibold py-2 px-4 rounded-lg hover:bg-gray-600 disabled:opacity-50">Berikutnya</button>
                    </div>
                </div>

                <div class="glass-card rounded-lg p-6">
                    <h3 class="font-semibold mb-3 text-gold text-lg">Deteksi & Ubah Massal</h3>
                    <textarea id="adminEmailListInput" class="w-full h-24 p-2 rounded-lg" placeholder="contoh@email.com, contoh2@email.com"></textarea>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mt-3">
                        <select id="statusChangeSelect" class="w-full rounded-lg py-2 px-3">
                            <option value="none">Hanya identifikasi</option>
                            <option value="Running">Ubah ke: Running</option>
                            <option value="Restric">Ubah ke: Restric</option>
                            <option value="Unrestric">Ubah ke: Unrestric</option>
                            <option value="running old">Ubah ke: Old</option>
                        </select>
                        <button id="adminCheckEmailsBtn" class="w-full bg-gold text-dark-bg font-semibold py-2 px-4 rounded-lg hover:bg-light-gold transition">Lakukan Aksi</button>
                    </div>
                    <button id="adminResetDetectionBtn" class="w-full bg-gray-700 text-white font-semibold py-2 px-4 rounded-lg hover:bg-gray-600 mt-3 hidden">Reset Filter</button>
                    <div id="adminDetectionResultSummary" class="mt-3 text-sm font-medium"></div>
                </div>

                <div class="relative mb-4">
                    <input type="text" id="adminEmailSearchInput" placeholder="Cari data admin..." class="w-full pl-4 pr-10 py-2 rounded-lg">
                    <button id="adminClearSearchBtn" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white hidden"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.707-10.293a1 1 0 00-1.414-1.414L8 8.586 6.707 7.293a1 1 0 10-1.414 1.414L6.586 10l-1.293 1.293a1 1 0 101.414 1.414L8 11.414l1.293 1.293a1 1 0 001.414-1.414L9.414 10l1.293-1.293z" clip-rule="evenodd" /></svg></button>
                </div>

                <div id="formContainer" class="glass-card rounded-lg p-6">
                    <h3 class="font-semibold mb-4 text-gold text-lg">Formulir Data</h3>
                    <form id="addDataForm" class="space-y-4">
                        <input type="hidden" id="dataIdInput">
                        <div><label for="emailInput" class="block text-sm font-medium mb-1">Email:</label><input type="email" id="emailInput" required class="block w-full rounded-md p-2"></div>
                        <div><label for="whatsappInput" class="block text-sm font-medium mb-1">No WhatsApp:</label><input type="tel" id="whatsappInput" required class="block w-full rounded-md p-2"></div>
                        <div><label for="rentalDateInput" class="block text-sm font-medium mb-1">Tanggal Rental:</label><input type="text" id="rentalDateInput" required class="block w-full rounded-md p-2"></div>
                        <div><label for="statusInput" class="block text-sm font-medium mb-1">Status:</label>
                            <select id="statusInput" required class="block w-full rounded-md p-2">
                                <option value="Running">Running</option><option value="Restric">Restric</option><option value="Unrestric">Unrestric</option><option value="running old">Old</option>
                            </select>
                        </div>
                        <div class="flex space-x-2"><button type="submit" id="submitDataBtn" class="w-full bg-green-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-green-700 transition">Tambah Data</button><button type="button" id="cancelEditBtn" class="w-full bg-red-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-red-600 transition hidden">Batal Edit</button></div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modals -->
    <div id="deleteConfirmModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[1000] hidden">
        <div class="glass-card rounded-lg p-8 text-center max-w-sm mx-4"><h2 class="text-xl font-bold mb-4 text-gold">Konfirmasi Hapus</h2><p class="text-gray-300 mb-6">Yakin ingin menghapus data ini?</p><div class="flex justify-center space-x-4"><button id="confirmDeleteBtn" class="bg-red-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-red-700 transition">Ya, Hapus</button><button id="cancelDeleteBtn" class="bg-gray-700 text-white font-semibold py-2 px-6 rounded-lg hover:bg-gray-600 transition">Batal</button></div></div>
    </div>
    <div id="statusChangeConfirmModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[1000] hidden">
         <div class="glass-card rounded-lg p-8 text-center max-w-sm mx-4"><h2 class="text-xl font-bold mb-4 text-gold">Konfirmasi</h2><p id="statusChangeConfirmText" class="text-gray-300 mb-6"></p><div class="flex justify-center space-x-4"><button id="confirmStatusChangeBtn" class="bg-yellow-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-yellow-700 transition">Ya, Ubah</button><button id="cancelStatusChangeBtn" class="bg-gray-700 text-white font-semibold py-2 px-6 rounded-lg hover:bg-gray-600 transition">Batal</button></div></div>
    </div>
    <div id="historyModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[1000] hidden">
        <div class="glass-card rounded-lg p-6 max-w-lg w-full mx-4"><button id="closeHistoryModalBtn" class="absolute top-3 right-3 text-gray-400 hover:text-white">&times;</button><h2 class="text-lg font-bold mb-4 text-gold">Riwayat Hapus</h2><div id="historyContent" class="space-y-3 max-h-96 overflow-y-auto"></div></div>
    </div>

    <script>
    // Konfigurasi JSONbin
    const BIN_ID = '68b3e78443b1c97be931c7c5';
    const API_KEY = '$2a$10$mx8berYVnQxRc7ATeB018Orxl1veAxJt/HhcqGd2CS6kSzL4yPg82';
    const JSONBIN_URL = `https://api.jsonbin.io/v3/b/${BIN_ID}`;

    // Elemen DOM
    const showTableBtn = document.getElementById('showTableBtn');
    const showAdminBtn = document.getElementById('showAdminBtn');
    const notification = document.getElementById('notification');
    const welcomeModal = document.getElementById('welcomeModal');
    const continueBtn = document.getElementById('continueBtn');
    const backgroundMusic = document.getElementById('backgroundMusic');
    const clickSound = new Audio('klik.mp3');
    const tableView = document.getElementById('tableView');
    const dataTableBody = document.getElementById('dataTableBody');
    const loadingIndicatorTable = document.getElementById('loadingIndicatorTable');
    const emailSearchInput = document.getElementById('emailSearchInput');
    const clearSearchBtn = document.getElementById('clearSearchBtn');
    const statusFilterSelect = document.getElementById('statusFilterSelect');
    const adminView = document.getElementById('adminView');
    const passwordSection = document.getElementById('passwordSection');
    const adminFormSection = document.getElementById('adminFormSection');
    const passwordInput = document.getElementById('passwordInput');
    const submitPasswordBtn = document.getElementById('submitPasswordBtn');
    const adminEmailSearchInput = document.getElementById('adminEmailSearchInput');
    const adminClearSearchBtn = document.getElementById('adminClearSearchBtn');
    const singleDataView = document.getElementById('singleDataView');
    const dataCard = document.getElementById('dataCard');
    const prevDataBtn = document.getElementById('prevDataBtn');
    const nextDataBtn = document.getElementById('nextDataBtn');
    const dataIndexDisplay = document.getElementById('dataIndexDisplay');
    const formContainer = document.getElementById('formContainer');
    const addDataForm = document.getElementById('addDataForm');
    const dataIdInput = document.getElementById('dataIdInput');
    const submitDataBtn = document.getElementById('submitDataBtn');
    const cancelEditBtn = document.getElementById('cancelEditBtn');
    const adminEmailListInput = document.getElementById('adminEmailListInput');
    const statusChangeSelect = document.getElementById('statusChangeSelect');
    const adminCheckEmailsBtn = document.getElementById('adminCheckEmailsBtn');
    const adminResetDetectionBtn = document.getElementById('adminResetDetectionBtn');
    const adminDetectionResultSummary = document.getElementById('adminDetectionResultSummary');
    const deleteConfirmModal = document.getElementById('deleteConfirmModal');
    const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
    const cancelDeleteBtn = document.getElementById('cancelDeleteBtn');
    const statusChangeConfirmModal = document.getElementById('statusChangeConfirmModal');
    const statusChangeConfirmText = document.getElementById('statusChangeConfirmText');
    const confirmStatusChangeBtn = document.getElementById('confirmStatusChangeBtn');
    const cancelStatusChangeBtn = document.getElementById('cancelStatusChangeBtn');
    const showHistoryBtn = document.getElementById('showHistoryBtn');
    const historyModal = document.getElementById('historyModal');
    const closeHistoryModalBtn = document.getElementById('closeHistoryModalBtn');
    const historyContent = document.getElementById('historyContent');
    
    // State Aplikasi
    let currentData = [], adminDisplayData = [], recentlyDeleted = [];
    let currentDataIndex = 0, dataToDeleteId = null, undoInterval;
    let massUpdatePayload = { emails: [], newStatus: '' };

    // Fungsi utilitas
    const playClickSound = () => { clickSound.currentTime = 0; clickSound.play(); }
    function showNotification(message, isError = false) {
        notification.textContent = message;
        notification.classList.remove('hidden', 'bg-green-500', 'bg-red-500');
        notification.classList.add(isError ? 'bg-red-500' : 'bg-green-500', 'scale-100');
        setTimeout(() => {
            notification.classList.remove('scale-100');
            notification.classList.add('scale-0');
            setTimeout(() => notification.classList.add('hidden'), 300);
        }, 3000);
    }

    // Fungsi API
    async function fetchBinData() {
        loadingIndicatorTable.classList.remove('hidden');
        try {
            const response = await fetch(`${JSONBIN_URL}/latest`, { headers: { 'X-Master-Key': API_KEY } });
            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            const data = await response.json();
            currentData = Array.isArray(data.record) ? data.record : (data.record.users || []);
            const statusOrder = { 'Running': 1, 'Unrestric': 2, 'running old': 3, 'Restric': 4 };
            currentData.sort((a, b) => (statusOrder[a.status] || 99) - (statusOrder[b.status] || 99) || (b.timestamp || 0) - (a.timestamp || 0));
        } catch (error) {
            console.error("Gagal mengambil data:", error); currentData = [];
        } finally {
            loadingIndicatorTable.classList.add('hidden');
        }
    }

    async function updateBinData(newArray) {
        try {
            const response = await fetch(JSONBIN_URL, {
                method: 'PUT', headers: { 'Content-Type': 'application/json', 'X-Master-Key': API_KEY },
                body: JSON.stringify(Array.isArray(newArray) ? newArray : { users: newArray })
            });
            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            return await response.json();
        } catch (error) {
            console.error("Gagal memperbarui data:", error); return null;
        }
    }

    // Fungsi Render Tampilan
    const getLightClass = s => (s === 'Restric' ? 'red' : (s === 'Running' || s === 'Unrestric' || s === 'running old' ? 'green' : ''));
    const getStatusTextColor = s => (s === 'Restric' ? 'text-red-400' : (s === 'Running' || s === 'Unrestric' || s === 'running old' ? 'text-green-400' : 'text-gray-400'));

    function renderPublicTable(data) {
        dataTableBody.innerHTML = data.length > 0 ? data.map(item => `
            <tr>
                <td class="py-3 px-4 break-words" data-label="Email">
                    <div class="flex items-center"><span>${item.email}</span><div class="blinking-light ${getLightClass(item.status)}"></div></div>
                </td>
                <td class="py-3 px-4 break-words" data-label="Keterangan">
                    <div><span>${item.rentalDate}</span><br><span class="font-semibold ${getStatusTextColor(item.status)}">${item.status}</span></div>
                </td>
            </tr>`).join('') : `<tr><td colspan="2" class="text-center py-4 text-gray-400">Tidak ada data yang cocok.</td></tr>`;
    }

    function filterAndRenderPublicView() {
        const status = statusFilterSelect.value;
        const term = emailSearchInput.value.toLowerCase();
        let data = currentData;
        if (status !== 'semua') data = data.filter(item => item.status === status);
        if (term) data = data.filter(item => item.email.toLowerCase().includes(term));
        renderPublicTable(data);
        clearSearchBtn.classList.toggle('hidden', term.length === 0);
    }
    
    function renderAdminSingleData() {
        if (adminDisplayData.length > 0) {
            const item = adminDisplayData[currentDataIndex];
            dataCard.innerHTML = `
                <div class="space-y-3">
                    <div class="flex justify-between items-center py-2 border-b"><span class="font-bold">Email:</span><div class="flex items-center"><span class="break-words text-right">${item.email}</span><div class="blinking-light ${getLightClass(item.status)}"></div></div></div>
                    <div class="flex justify-between items-center py-2 border-b"><span class="font-bold">No WhatsApp:</span><span class="break-words text-right">${item.whatsapp}</span></div>
                    <div class="flex justify-between items-center py-2 border-b"><span class="font-bold">Tanggal Rental:</span><span class="break-words text-right">${item.rentalDate}</span></div>
                    <div class="flex justify-between items-center py-2"><span class="font-bold">Status:</span><span class="break-words text-right">${item.status}</span></div>
                </div>
                <div class="flex space-x-2 mt-4 justify-end">
                    <button class="editBtn bg-yellow-500 text-white py-1 px-3 rounded-md text-xs font-semibold hover:bg-yellow-600" data-id="${item.id}">Edit</button>
                    <button class="deleteBtn bg-red-500 text-white py-1 px-3 rounded-md text-xs font-semibold hover:bg-red-600" data-id="${item.id}">Hapus</button>
                </div>`;
            dataCard.querySelector('.editBtn').onclick = () => { playClickSound(); handleEdit(item.id); };
            dataCard.querySelector('.deleteBtn').onclick = () => { playClickSound(); handleDelete(item.id); };
            dataIndexDisplay.textContent = `${currentDataIndex + 1} / ${adminDisplayData.length}`;
            prevDataBtn.disabled = currentDataIndex === 0;
            nextDataBtn.disabled = currentDataIndex === adminDisplayData.length - 1;
        } else {
            dataCard.innerHTML = `<p class="text-center py-4 text-gray-500">Tidak ada data untuk ditampilkan.</p>`;
            dataIndexDisplay.textContent = '0 / 0';
            prevDataBtn.disabled = true; nextDataBtn.disabled = true;
        }
    }
    
    // --- Event Listeners ---
    showTableBtn.onclick = () => { playClickSound(); switchMode(false); };
    showAdminBtn.onclick = () => { playClickSound(); switchMode(true); };
    emailSearchInput.onkeyup = filterAndRenderPublicView;
    statusFilterSelect.onchange = () => { playClickSound(); filterAndRenderPublicView(); };
    clearSearchBtn.onclick = () => { playClickSound(); emailSearchInput.value = ''; filterAndRenderPublicView(); };

    submitPasswordBtn.onclick = () => {
        playClickSound();
        if (passwordInput.value === "Arkana123") {
            passwordSection.classList.add('hidden'); adminFormSection.classList.remove('hidden');
            fetchBinData().then(() => { adminDisplayData = [...currentData]; renderAdminSingleData(); });
        } else { showNotification("Sandi salah!", true); }
    };
    
    prevDataBtn.onclick = () => { playClickSound(); if (currentDataIndex > 0) { currentDataIndex--; renderAdminSingleData(); } };
    nextDataBtn.onclick = () => { playClickSound(); if (currentDataIndex < adminDisplayData.length - 1) { currentDataIndex++; renderAdminSingleData(); } };
    
    adminEmailSearchInput.onkeyup = () => {
        const term = adminEmailSearchInput.value.toLowerCase();
        adminDisplayData = currentData.filter(item => item.email.toLowerCase().includes(term));
        currentDataIndex = 0; renderAdminSingleData();
        adminClearSearchBtn.classList.toggle('hidden', term.length === 0);
    };
    adminClearSearchBtn.onclick = () => { playClickSound(); adminEmailSearchInput.value = ''; adminDisplayData = [...currentData]; currentDataIndex = 0; renderAdminSingleData(); adminClearSearchBtn.classList.add('hidden'); };

    adminCheckEmailsBtn.onclick = () => { /* ... (logic tidak berubah) */ };
    confirmStatusChangeBtn.onclick = async () => { /* ... (logic tidak berubah) */ };
    cancelStatusChangeBtn.onclick = () => { playClickSound(); statusChangeConfirmModal.classList.add('hidden'); };
    adminResetDetectionBtn.onclick = () => { /* ... (logic tidak berubah) */ };
    
    function handleEdit(id) { /* ... (logic tidak berubah) */ }
    function handleDelete(id) { dataToDeleteId = id; deleteConfirmModal.classList.remove('hidden'); }
    cancelDeleteBtn.onclick = () => { playClickSound(); deleteConfirmModal.classList.add('hidden'); dataToDeleteId = null; };
    cancelEditBtn.onclick = () => { playClickSound(); resetFormAndMode(); };

    confirmDeleteBtn.onclick = async () => { /* ... (logic tidak berubah) */ };
    function resetFormAndMode() { /* ... (logic tidak berubah) */ }
    addDataForm.onsubmit = async (e) => { /* ... (logic tidak berubah) */ };

    showHistoryBtn.onclick = () => { playClickSound(); renderHistoryModal(); historyModal.classList.remove('hidden'); clearInterval(undoInterval); undoInterval = setInterval(renderHistoryModal, 1000); };
    closeHistoryModalBtn.onclick = () => { playClickSound(); historyModal.classList.add('hidden'); clearInterval(undoInterval); };
    
    function renderHistoryModal() { /* ... (logic tidak berubah) */ }
    async function handleUndo(id) { /* ... (logic tidak berubah) */ }

    function switchMode(isAdmin) {
        showAdminBtn.classList.toggle('active', isAdmin);
        showTableBtn.classList.toggle('active', !isAdmin);
        adminView.classList.toggle('hidden', !isAdmin);
        tableView.classList.toggle('hidden', isAdmin);

        if(isAdmin && !passwordSection.classList.contains('hidden')) {
            fetchBinData().then(() => { adminDisplayData = [...currentData]; renderAdminSingleData(); });
        } else if (!isAdmin) {
            fetchBinData().then(filterAndRenderPublicView);
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        continueBtn.onclick = () => {
            playClickSound(); welcomeModal.classList.add('hidden');
            try { backgroundMusic.play(); } catch(e) { console.warn("Autoplay musik diblokir oleh browser."); }
            switchMode(false);
        };
    });
</script>
</body>
</html>

